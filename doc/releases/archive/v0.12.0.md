# OraDBA v0.12.0 Release Notes

**Release Date:** January 2, 2026

## Overview

OraDBA v0.12.0 introduces a major new feature: the **Extension System**, a modular
plugin architecture that allows users to add custom scripts and tools without modifying
the core OraDBA installation. This release makes OraDBA more flexible and maintainable
for organizations with custom requirements.

## What's New

### Extension System (#15)

The extension system enables modular, customer-specific enhancements to OraDBA through a clean plugin architecture.

**Key Features:**

- **Auto-Discovery**: Automatically discovers extensions in `${ORADBA_LOCAL_BASE}` (e.g., `/opt/oracle/local/customer`)
- **Directory Structure**: Support for `bin/`, `sql/`, `rcv/`, `etc/`, `lib/` directories
- **Metadata Files**: Optional `.extension` files in YAML-like format for version tracking
- **Priority-Based Loading**: Control load order with numeric priorities (lower = higher priority)
- **Configuration Overrides**: Per-extension enable/disable and priority settings
- **Automatic Integration**: Extensions seamlessly integrate into PATH, SQLPATH, and RMAN paths
- **Navigation Aliases**: Auto-generated `cde<name>` aliases for quick access
- **Coexistence Mode Support**: Extensions respect OraDBA coexistence mode settings

### Management Tool

New `oradba_extension.sh` command-line utility provides comprehensive extension management:

```bash
# List all extensions
oradba_extension.sh list

# Show detailed information
oradba_extension.sh info customer

# Validate extension structure
oradba_extension.sh validate customer

# View enabled/disabled extensions
oradba_extension.sh enabled
oradba_extension.sh disabled
```

**Available Commands:**

- `list` - Show all extensions with status, version, priority
- `info` - Display detailed extension information
- `validate` - Validate extension structure and configuration
- `validate-all` - Validate all discovered extensions
- `discover` - Show auto-discovered extensions
- `paths` - Display extension search paths
- `enabled` - List only enabled extensions
- `disabled` - List only disabled extensions

### Comprehensive Testing

31 BATS test cases ensure reliability:

- Extension discovery (auto and manual)
- Metadata parsing and fallbacks
- Priority and enable/disable configuration
- Extension loading and PATH integration
- Configuration overrides
- Validation warnings
- Full integration workflow

### Documentation

- **[Extension System Guide](../extension-system.md)**: Complete documentation with examples
- **Example Extension**: `doc/examples/extensions/customer/` provides a reference implementation
- **Best Practices**: Guidelines for creating maintainable extensions

## Technical Details

### Architecture

The extension system is built around three core components:

1. **`lib/extensions.sh`**: Core library (550+ lines) with discovery, loading, and management functions
2. **`bin/oradba_extension.sh`**: Management CLI tool (596 lines) with 8 commands
3. **`tests/test_extensions.bats`**: Comprehensive test suite (31 tests)

### Configuration Variables

New configuration options in `oradba_core.conf`:

```bash
ORADBA_AUTO_DISCOVER_EXTENSIONS  # Enable/disable auto-discovery (default: true)
ORADBA_EXTENSION_PATHS           # Colon-separated manual extension paths
ORADBA_EXTENSIONS_IN_COEXIST     # Load extensions with BasEnv (default: false)
ORADBA_RCV_PATHS                 # RMAN script search paths (populated by extensions)
```

Per-extension overrides in `oradba_customer.conf`:

```bash
ORADBA_EXT_<NAME>_ENABLED   # Enable/disable specific extension
ORADBA_EXT_<NAME>_PRIORITY  # Override priority for specific extension
```

### PATH Integration

Extensions are integrated into PATH with careful ordering:

1. **Core OraDBA** (`${ORADBA_BIN}`)
2. **Extensions** (by priority: high priority loaded last, appears first)
3. **Oracle Home** (`${ORACLE_HOME}/bin`)
4. **System PATH**

This ensures high-priority extensions can override Oracle tools while respecting core OraDBA commands.

## Bug Fixes

### Extension Priority Sorting

Fixed a critical bug in the initial implementation where extensions were loading in the wrong order:

- **Problem**: Lower priority numbers (higher priority) were appearing last in PATH
- **Solution**: Reversed sort order so high-priority extensions load last and appear first in PATH
- **Impact**: Ensures proper command resolution order

## Upgrade Notes

### Compatibility

- **Backward Compatible**: No breaking changes to existing OraDBA installations
- **Optional Feature**: Extension system is opt-in and disabled by default in coexistence mode
- **Configuration**: Existing configurations work without modification

### Migration

No migration steps required. To start using extensions:

1. **Create extension directory**:

   ```bash
   mkdir -p /opt/oracle/local/customer/bin
   ```

2. **Add scripts**:

   ```bash
   cp my_script.sh /opt/oracle/local/customer/bin/
   chmod +x /opt/oracle/local/customer/bin/my_script.sh
   ```

3. **Optional: Add metadata**:

   ```bash
   cat > /opt/oracle/local/customer/.extension << EOF
   name: customer
   version: 1.0.0
   priority: 10
   description: Customer-specific Oracle tools
   EOF
   ```

4. **Source OraDBA**:

   ```bash
   source oraenv.sh
   # Extension auto-loaded and added to PATH
   ```

### Testing

After upgrade, verify extension functionality:

```bash
# Test discovery
oradba_extension.sh discover

# List extensions
oradba_extension.sh list

# Validate structure
oradba_extension.sh validate-all
```

## Known Issues

None at this time.

## Contributors

- Stefan Oehrli (oes) - <stefan.oehrli@oradba.ch>

## Resources

- **Documentation**: [Extension System Guide](../extension-system.md)
- **Examples**: `doc/examples/extensions/customer/`
- **Issue Tracker**: [GitHub Issues](https://github.com/oehrlis/oradba/issues)
- **Repository**: [GitHub](https://github.com/oehrlis/oradba)

## Next Steps

After installing v0.12.0:

1. **Review Documentation**: Read the [Extension System Guide](../extension-system.md)
2. **Create Extensions**: Use the example extension as a template
3. **Test Functionality**: Run `oradba_extension.sh list` to verify setup
4. **Provide Feedback**: Report issues or suggestions on GitHub

---

For complete change details, see [CHANGELOG.md](../../CHANGELOG.md#0120---2026-01-02).
