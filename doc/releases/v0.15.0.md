# OraDBA v0.15.0 Release Notes

**Release Date:** 2026-01-07

## Overview

Version 0.15.0 introduces significant improvements to the extension system, including automated template management from GitHub, customizable integrity checking with `.checksumignore` support, and streamlined build processes. This release decouples extension templates from the main repository, improving maintainability and reducing duplication.

## Major Changes

### Extension Template Repository Migration

Extension templates have been moved to a dedicated GitHub repository for better separation of concerns:

- **New Repository**: [oehrlis/oradba_extension](https://github.com/oehrlis/oradba_extension)
- **Automated Downloads**: Build process automatically downloads latest template from GitHub releases
- **Version Caching**: Templates cached in `templates/oradba_extension/extension-template.tar.gz`
- **Version Tracking**: Template version stored in `templates/oradba_extension/.version`
- **Reduced Duplication**: Eliminates template duplication between repositories

**Impact**: Users creating extensions will automatically get the latest template. The installer includes the template, but it can also be downloaded on-demand from GitHub.

### Checksum Exclusion Support (.checksumignore)

Introduced customizable integrity checking with the new `.checksumignore` file:

- **Per-Extension Configuration**: Each extension can define its own exclusion patterns
- **Glob Pattern Support**: Full wildcard support with `*`, `?`, and directory matching
- **Default Exclusions**: `.extension`, `.checksumignore`, and `log/` always excluded
- **Common Use Cases**:
  - Runtime files: `cache/`, `tmp/`, `*.tmp`
  - Credentials: `keystore/`, `secrets/`, `*.key`, `*.pem`
  - User configs: `etc/*.local`

**Example `.checksumignore`**:

```text
# Runtime files
cache/
*.tmp

# Credentials
keystore/
*.key

# User-specific configs
etc/*.local
```

**Impact**: More flexible integrity checking that accommodates real-world extension needs without false positives for runtime-generated or user-specific files.

### Build Process Enhancements

New make targets for streamlined development:

- **`make download-extensions`**: Manually download latest template from GitHub
- **`make clean-extensions`**: Clean downloaded templates
- **Automated Version Checking**: Build only downloads if newer version available
- **Integrated Cleanup**: `make clean-all` now includes extension cleanup

## Technical Details

### Extension Template Workflow

1. **During Build**:
   - `scripts/build_installer.sh` queries GitHub API for latest release
   - Compares with cached version in `templates/oradba_extension/.version`
   - Downloads tarball if newer or missing
   - Includes template in distribution

2. **Extension Creation**:
   - `oradba_extension.sh create` uses local template by default
   - Falls back to GitHub with `--from-github` flag
   - Supports custom templates with `--template` flag
   - Displays template version when available

### Checksum Exclusion Implementation

- **Function**: `get_checksum_exclusions()` in `oradba_version.sh`
- **Pattern Parsing**: Converts glob patterns to awk regex
- **Integration**: Applied in both `show_installed_extensions()` and `check_extension_checksums()`
- **Backward Compatible**: Works without `.checksumignore` file (uses defaults)

## Files Changed

### Core Files

- `scripts/build_installer.sh` - GitHub template download logic
- `src/bin/oradba_extension.sh` - Updated template path
- `src/bin/oradba_version.sh` - Added `.checksumignore` support
- `Makefile` - New extension management targets

### Documentation

- `doc/extension-system.md` - Comprehensive `.checksumignore` documentation
- `src/doc/18-extensions.md` - Troubleshooting with exclusion patterns
- `CHANGELOG.md` - All changes documented

### Infrastructure

- `.gitignore` - Updated for new template directory
- `templates/oradba_extension/.gitkeep` - Track template directory

## Breaking Changes

None. This release is fully backward compatible:

- Existing extensions work without modification
- Extensions without `.checksumignore` use default exclusions
- Old extension creation workflow unchanged (just uses new template path)

## Upgrade Instructions

### From v0.14.x

No special steps required:

1. Download and install v0.15.0
2. Extension templates automatically downloaded during build
3. Existing extensions continue working

### For Extension Developers

To take advantage of new features:

1. **Add `.checksumignore` to Extensions**:
   ```bash
   # In your extension directory
   cat > .checksumignore << 'EOF'
   # Your exclusion patterns
   log/
   keystore/
   *.tmp
   EOF
   ```

2. **Update Extension Template** (if maintaining custom template):
   - Reference [oradba_extension v0.2.0](https://github.com/oehrlis/oradba_extension/releases/tag/v0.2.0)
   - Include `.checksumignore` in template

## Testing

- ✅ All 52 existing extension tests pass
- ✅ Template download verified (v0.1.1 → v0.2.0)
- ✅ `.checksumignore` included in template tarball
- ✅ Pattern matching validated with test cases
- ✅ Backward compatibility confirmed

## Related Releases

- **oradba_extension v0.2.0**: Includes `.checksumignore` template
  - Download: [GitHub Release](https://github.com/oehrlis/oradba_extension/releases/tag/v0.2.0)

## Migration Notes

### Template Location Change

| Old Path | New Path |
|----------|----------|
| `src/templates/extensions/customer-extension-template.tar.gz` | `templates/oradba_extension/extension-template.tar.gz` |

The path change is transparent to users - `oradba_extension.sh` handles it automatically.

### Checksum Verification Changes

**Before v0.15.0**:
- Hard-coded exclusions: `.extension` and `log/`
- No customization possible

**After v0.15.0**:
- Same defaults maintained
- Plus `.checksumignore` for custom exclusions
- Glob pattern support for flexible matching

## Known Issues

None reported.

## Future Enhancements

Potential improvements for future releases:

- Global `.checksumignore` patterns in `oradba_customer.conf`
- Regex pattern support in addition to globs
- Extension template versioning in metadata
- Multi-repo extension discovery

## Links

- **Repository**: [github.com/oehrlis/oradba](https://github.com/oehrlis/oradba)
- **Extension Template**: [github.com/oehrlis/oradba_extension](https://github.com/oehrlis/oradba_extension)
- **Documentation**: [OraDBA User Guide](https://oehrlis.github.io/oradba/)
- **Issues**: [GitHub Issues](https://github.com/oehrlis/oradba/issues)

## Contributors

- Stefan Oehrli ([@oehrlis](https://github.com/oehrlis))

---

For detailed changes, see [CHANGELOG.md](../../CHANGELOG.md#0150---2026-01-07).
