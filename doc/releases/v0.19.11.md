# Release Notes v0.19.11

**Release Date:** TBD  
**Type:** Minor Release (Plugin Interface Enhancements)

## Overview

Version 0.19.11 enhances the plugin interface (v1.0.0) with improved environment
management functions and separates listener logic for better product-specific
handling. This release introduces new plugin functions for building environment
variables and managing multi-instance products.

## üéØ Highlights

### Plugin Interface Enhancements

**Function Rename for Clarity**: The generic `plugin_build_path` function has been
split into two specialized functions:

- `plugin_build_bin_path` - Returns PATH components (executables)
- `plugin_build_lib_path` - Returns LD_LIBRARY_PATH components (shared libraries)

**New Environment Functions**: Enhanced environment management with new plugin functions:

- `plugin_build_base_path` - Resolves ORACLE_BASE_HOME vs ORACLE_HOME for products
  with complex installation layouts
- `plugin_build_env` - Unified function to build all environment variables for a
  product/instance (ORACLE_HOME, PATH, LD_LIBRARY_PATH, etc.)
- `plugin_get_instance_list` - Enumerates instances/domains for multi-instance
  products (databases, middleware)

**Listener Logic Separation**: Category-specific functions for listener management:

- `plugin_should_show_listener` - Determines if product's listener should appear
  in listener sections (database vs DataSafe distinction)
- `plugin_check_listener_status` - Checks listener status per Oracle Home
  (separated from instance status checks)

## üì¶ What's Changed

### Plugin Interface Updates

#### Removed Functions

- `plugin_build_path` (deprecated) - Replaced by `plugin_build_bin_path` and
  `plugin_build_lib_path` for better separation of PATH vs library path management

#### New Functions

All plugins now implement these additional functions:

```bash
# Resolve installation base path
plugin_build_base_path()
  Args: $1 - Input ORACLE_HOME or ORACLE_BASE_HOME
  Returns: 0=success
  Output: Normalized base path

# Build complete environment
plugin_build_env()
  Args: $1 - ORACLE_HOME, $2 - Instance/domain identifier (optional)
  Returns: 0=success, 1=n/a, 2=unavailable
  Output: Key=value pairs (one per line)

# Get PATH components
plugin_build_bin_path()
  Args: $1 - ORACLE_HOME path
  Returns: 0=success
  Output: Colon-separated PATH components

# Get LD_LIBRARY_PATH components
plugin_build_lib_path()
  Args: $1 - ORACLE_HOME path
  Returns: 0=success
  Output: Colon-separated library path components

# Enumerate instances/domains
plugin_get_instance_list()
  Args: $1 - ORACLE_HOME path
  Returns: 0=success
  Output: instance_name|status|metadata (one per line)

# Category-specific: Show listener?
plugin_should_show_listener()
  Args: None
  Returns: 0=yes, 1=no
  Output: None

# Category-specific: Check listener status
plugin_check_listener_status()
  Args: $1 - ORACLE_HOME path
  Returns: 0=running, 1=stopped, 2=unavailable
  Output: Status string
```

### Exit Code Expectations (Unchanged)

Plugin return value standards remain consistent with v1.0.0:

- **0** - Success (with clean data on stdout)
- **1** - Not applicable / expected failure (no data)
- **2** - Error / unavailable (no data)

No sentinel strings ("ERR", "unknown", "N/A") are returned on stdout for status
functions - only clean data or exit codes.

## üîß Action Required for Plugin Authors

If you maintain custom OraDBA plugins, update them to implement the new functions:

1. **Split path building logic**:
   - Replace `plugin_build_path` with `plugin_build_bin_path` and `plugin_build_lib_path`
   - `plugin_build_bin_path` returns executable directories only
   - `plugin_build_lib_path` returns library directories only

2. **Add new environment functions**:
   - Implement `plugin_build_base_path` (usually returns `$ORACLE_HOME`)
   - Implement `plugin_build_env` to consolidate environment variable generation
   - Implement `plugin_get_instance_list` for multi-instance products

3. **Add listener functions (if applicable)**:
   - Implement `plugin_should_show_listener` (return 0 for database products, 1 for others)
   - Implement `plugin_check_listener_status` if your product uses Oracle listeners

4. **Reference materials**:
   - See `doc/plugin-standards.md` for complete interface specification
   - See `doc/plugin-development.md` for implementation guide
   - See `src/lib/plugins/database_plugin.sh` for reference implementation
   - See `.github/copilot-instructions.md` for development standards

## üìö Documentation Updates

- Updated `doc/plugin-standards.md` with new function specifications
- Updated `doc/plugin-development.md` with implementation examples
- Updated `.github/copilot-instructions.md` with plugin development patterns
- Updated `.github/.scratch/plugin-refactor-plan.md` with refactoring details

## üîÑ Compatibility

- Fully backward compatible with OraDBA v0.19.x
- Existing plugins continue to work (graceful degradation)
- Custom plugins should be updated to use new functions for full feature support

## üìù Upgrade Notes

```bash
# Standard upgrade
bash oradba_install.sh --update

# Verify version
oradba_version.sh --check
```

## üêõ Related Issues

- Implementation tracked in Phase 2 refactoring plan
- See `.github/.scratch/plugin-refactor-plan.md` for complete details

## üìñ Support Information

- **Documentation**: [OraDBA Documentation](https://oehrlis.github.io/oradba/)
- **Plugin Standards**: [doc/plugin-standards.md](../plugin-standards.md)
- **Plugin Development**: [doc/plugin-development.md](../plugin-development.md)
- **Issues**: [GitHub Issues](https://github.com/oehrlis/oradba/issues)
- **Changelog**: [CHANGELOG.md](../../CHANGELOG.md)

---

**Full Changelog**: [v0.19.10...v0.19.11](https://github.com/oehrlis/oradba/compare/v0.19.10...v0.19.11)
