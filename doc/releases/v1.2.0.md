# Release Notes - OraDBA v1.2.0

**Release Date:** January 16, 2026

## Overview

Version 1.2.0 is a maintenance release that fixes critical bugs in status display
and significantly enhances Oracle Home management beyond database SIDs. This
release improves the user experience for environments with DataSafe connectors,
Instant Client, OUD, WebLogic, and other Oracle products.

## Key Improvements

### Enhanced Oracle Home Management

The `oradba_env.sh` utility now provides full support for all Oracle Homes
registered in `oradba_homes.conf`, not just database SIDs from oratab:

- **Unified Command Interface**: All commands (list, show, status, validate) work with Oracle Home names/aliases
- **Automatic Lookup**: Searches oradba_homes.conf first, then falls back to oratab
- **Product Flexibility**: Supports DataSafe, Instant Client, OUD, WebLogic, OMS, EM Agent, and more
- **Target Validation**: New optional target parameter for `validate` command

**Examples:**

```bash
# List all Oracle Homes with proper formatting
oradba_env.sh list

# Show DataSafe connector details by name
oradba_env.sh show dscontest

# Check DataSafe connector status
oradba_env.sh status dscontest

# Validate specific Oracle Home
oradba_env.sh validate dscontest
```

### Fixed Status Display Bugs

#### Concatenation Bug Fix

Fixed critical bug where status values were concatenated when functions returned
errors, resulting in confusing displays like "unknownavailable" or "unknownstopped".

**Root Cause:** Fallback patterns like `|| echo "available"` executed even when
functions successfully output error states, causing both values to be concatenated.

**Before:**

```text
Data Safe         : dscontest    unknownavailable /opt/oracle/product/connector
Connection Manager : dscontest    unknown
stopped /opt/oracle/product/connector/oracle_cman_home
```

**After:**

```text
Data Safe         : dscontest    unknown     /opt/oracle/product/connector
Connector         : dscontest    unknown     /opt/oracle/product/connector/oracle_cman_home
```

#### Improved Status Logic

Status values now accurately reflect installation state:

| Status        | Meaning                                                  |
|---------------|----------------------------------------------------------|
| `unavailable` | Directory doesn't exist (path not found)                 |
| `unknown`     | Directory exists but cmctl not found/executable          |
| `stopped`     | Installation exists, connector installed but not running |
| `running`     | Connector actively running (shows port number)           |
| `missing`     | Oracle Home path doesn't exist (Oracle Homes section)    |

**Implementation:**

- Added directory existence checks before status queries
- Removed problematic `|| echo` fallbacks from oradba_check_datasafe_status calls
- Proper error handling with clear status progression

### Display Alignment Fix

Fixed alignment issues in Data Safe Status section:

- **Before:** "Connection Manager" (18 chars) exceeded format width, shifting all columns
- **After:** "Connector" (9 chars) maintains proper column alignment

All status sections now use consistent 17-character width for type column.

### Oracle Homes List Format Fix

Fixed parsing and display of Oracle Homes in `oradba_env.sh list`:

- **Before:** Incorrectly parsed `oradba_list_all_homes` output, showing pipe-delimited raw data
- **After:** Properly parses NAME|PATH|TYPE|ORDER|ALIAS format
- **Display:** Shows alias (if different from name) or name, with consistent formatting

**Before:**

```text
datasafe|50|dstest /opt/oracle/product/connector dscontest
```

**After:**

```text
dstest          datasafe   /opt/oracle/product/connector
```

## GitHub Copilot Integration

Added comprehensive AI coding guidelines:

- **Main Project:** `.github/copilot-instructions.md` with OraDBA-specific patterns
- **Extensions:** Custom instructions for each extension template (oradba_extension, odb_autoupgrade, odb_datasafe)
- **Patterns Documented:**
  - Database query patterns with `execute_db_query()`
  - Logging conventions with `oradba_log`
  - Test workflows and make targets
  - Validation scripts
- **Workflow:** Created `.github/.scratch/` for temporary AI-generated files

## Technical Changes

### Modified Files

- **src/bin/oraup.sh**
  - Removed `|| echo "available"` fallback in Oracle Homes section (line 448)
  - Added directory existence check in Data Safe Status section
  - Removed `|| echo "stopped"` fallback in Data Safe Status section (line 592)
  - Changed "Connection Manager" to "Connector" for alignment
  
- **src/bin/oradba_env.sh**
  - Enhanced `cmd_list()` to properly parse oradba_list_all_homes output
  - Updated `cmd_show()` to check oradba_homes.conf first
  - Enhanced `cmd_status()` to support Oracle Homes from oradba_homes.conf
  - Updated `cmd_validate()` to accept optional target parameter
  - Added temporary ORACLE_HOME override for validation

- **CHANGELOG.md**
  - Added v1.2.0 section with all changes

- **.github/copilot-instructions.md**
  - Comprehensive AI coding guidelines for main project and all extensions

- **.gitignore**
  - Added `.github/.scratch/*` for temporary files

## Upgrade Notes

### Breaking Changes

None. All changes are backward compatible.

### Compatibility

- **Tested with:** Oracle 11g through 23ai
- **Platforms:** Linux (all major distributions), macOS
- **Requirements:** Bash 4.0+

### Migration

No migration required. Existing installations will work without changes.

## Known Issues

None.

## Future Enhancements

Planned for v1.3.0:

- Enhanced logging and debugging capabilities
- Additional Oracle product type support
- Performance optimizations for large environments

## Contributors

- Stefan Oehrli (@oehrlis) - All changes

## Links

- **GitHub Repository:** <https://github.com/oehrlis/oradba>
- **Documentation:** <https://oradba.ch/docs>
- **Issue Tracker:** <https://github.com/oehrlis/oradba/issues>

---

For complete details, see the [CHANGELOG](../../CHANGELOG.md).
