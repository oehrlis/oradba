# OraDBA v1.1.0 Release Notes

**Release Date:** January 15, 2026  
**Release Type:** Minor Release  
**Compatibility:** Fully compatible with v1.0.0

## Overview

OraDBA v1.1.0 adds comprehensive support for Oracle Data Safe On-Premises Connectors
and Oracle Instant Client environments, along with significant improvements to PATH
handling, display output, and parser format consistency. This release focuses on
production environment stability and enhanced product type detection.

**Key Highlights:**

- ðŸ”’ Full Data Safe On-Premises Connector support (DATASAFE product type)
- âš¡ Instant Client (ICLIENT) support with proper detection and environment setup
- ðŸŽ¯ Direct cmctl status checking (50-100ms faster than Python-based approach)
- ðŸ”„ PATH deduplication to prevent repeated entries
- ðŸ“Š Improved oraup.sh display for non-database Oracle Homes
- ðŸ”§ Parser format alignment for consistency across the codebase

## What's New

### Data Safe On-Premises Connector Support

**Feature:** Complete support for Oracle Data Safe On-Premises Connectors

OraDBA now fully supports Data Safe connector installations with proper environment
setup, validation, and status monitoring.

**Product Type Detection:**

- Detects `oracle_cman_home` directory structure
- Validates `cmctl` binary presence
- Auto-configures environment for Data Safe connectors

**Environment Setup:**

```bash
# Data Safe-specific paths
export PATH="$ORACLE_HOME/oracle_cman_home/bin:$PATH"
export LD_LIBRARY_PATH="$ORACLE_HOME/oracle_cman_home/lib:$LD_LIBRARY_PATH"
```

**Status Monitoring:**

```bash
$ oraup.sh

Oracle Homes
---------------------------------------------------------------------------------
Data Safe       : dsconha1     running     /appl/oracle/product/exacc-wob-vwg-ha1
Data Safe       : dsconha2     stopped     /appl/oracle/product/exacc-wob-vwg-ha2
```

**Registration:**

```bash
oradba_homes.sh add \
  --name "dsconha1" \
  --path "/appl/oracle/product/exacc-wob-vwg-ha1" \
  --type "datasafe" \
  --alias "dsha1" \
  --desc "DataSafe Connector ds-conn-exacc-wob-vwg-ha1"
```

**Key Features:**

- âœ… Direct cmctl status checking (50-100ms faster than Python)
- âœ… Proper PATH and LD_LIBRARY_PATH configuration
- âœ… Validation skips sqlplus check (not required for Data Safe)
- âœ… Live status display: RUNNING/STOPPED/UNKNOWN
- âœ… Connector name display in oraup.sh

**New Functions:**

- `oradba_check_datasafe_status()` - Direct cmctl-based status checking

### Oracle Instant Client (ICLIENT) Support

**Feature:** Proper detection and handling of Oracle Instant Client installations

Instant Client is now recognized as a distinct product type (ICLIENT) with special
handling for its unique directory structure (no bin subdirectory).

**Product Type Detection:**

- Detects presence of `libclntsh.so` (or platform equivalent)
- Confirms absence of `bin` directory
- Auto-categorizes as ICLIENT (not CLIENT)

**Environment Setup:**

```bash
# Instant Client uses ORACLE_HOME directly (no bin subdirectory)
export PATH="$ORACLE_HOME:$PATH"
export LD_LIBRARY_PATH="$ORACLE_HOME:$LD_LIBRARY_PATH"
```

**Validation:**

- Skips checks for database-specific features
- Validates Instant Client-specific binaries
- No sqlplus requirement

**Registration:**

```bash
oradba_homes.sh add \
  --name "iclient26" \
  --path "/appl/oracle/product/23.26.0.0/iclient" \
  --type "iclient" \
  --alias "ic26" \
  --desc "Oracle AI Database Instant Client"
```

**Key Features:**

- âœ… Proper PATH setup (ORACLE_HOME directly, not bin)
- âœ… Proper LD_LIBRARY_PATH setup (ORACLE_HOME directly)
- âœ… Distinct from full CLIENT product type
- âœ… Validation adjusted for client-only features

### TNS Ping Wrapper with Instant Client Support

**Feature:** Transparent tnsping alias that works across all Oracle product types

OraDBA now provides a smart tnsping wrapper that automatically adapts to the
available tools in your environment, ensuring seamless network connectivity testing
across database installations, client installations, and Instant Client environments.

**How It Works:**

```bash
# Same command works everywhere
$ tnsping FREE

# On database/client installations â†’ uses native tnsping
TNS Ping Utility for Linux: Version 19.0.0.0.0 - Production
Attempting to contact FREE
OK (10 msec)

# On Instant Client â†’ automatically uses sqlplus -P
# (Shows notice only in verbose/debug mode)
```

**Supported Formats:**

```bash
# TNS names
tnsping FREE
tnsping FREE.world

# EZ Connect
tnsping 172.18.0.3:1521/FREE
tnsping dbhost.example.com:1521/PRODDB
```

**Connect Descriptor Limitation:**

```bash
# Not supported with Instant Client (sqlplus -P limitation)
$ tnsping "(DESCRIPTION=(CONNECT_DATA=(SERVICE_NAME=FREE))...)"
Error: sqlplus -P does not support full connect descriptors
       Use TNS name or EZ Connect format: host:port/service
```

**Key Features:**

- âœ… Automatic tool detection (tnsping or sqlplus -P)
- âœ… Works with TNS names and EZ Connect strings
- âœ… Clear error messages for unsupported formats
- âœ… Informational notice in verbose/debug mode
- âœ… Preserves all command-line arguments
- âœ… Only active when ORACLE_HOME is set

**Implementation:**

- `oradba_tnsping()` function in oradba_aliases.sh
- Checks for `$ORACLE_HOME/bin/tnsping` first
- Falls back to `sqlplus -P` for Instant Client
- Validates connect descriptor format
- Shows helpful error messages

### PATH Deduplication

**Feature:** Automatic removal of duplicate PATH entries

Prevents PATH pollution from repeated JDK paths and other duplicate directories.

**Implementation:**

```bash
# New function: oradba_dedupe_path
# - Preserves order (first occurrence wins)
# - Handles platform differences (Linux, macOS, AIX, Solaris)
# - Automatically applied after environment setup
```

**Behavior:**

```bash
# Before deduplication
$ echo $PATH
/opt/java/jdk/bin:/u01/app/oracle/product/19/bin:/opt/java/jdk/bin:/usr/bin

# After deduplication
$ echo $PATH
/opt/java/jdk/bin:/u01/app/oracle/product/19/bin:/usr/bin
```

**Key Features:**

- âœ… Removes duplicate PATH entries
- âœ… Removes duplicate LD_LIBRARY_PATH entries
- âœ… Preserves PATH order
- âœ… Platform-aware (handles SHLIB_PATH, LIBPATH, DYLD_LIBRARY_PATH)

**New Functions:**

- `oradba_dedupe_path()` - PATH deduplication logic

### Directory Existence Validation

**Feature:** Validation before adding directories to PATH

Prevents addition of non-existent directories to PATH and LD_LIBRARY_PATH.

**Behavior:**

```bash
# Only existing directories added to PATH
if [[ -n "$new_path" ]] && [[ -d "$new_path" ]]; then
    export PATH="${new_path}:${PATH}"
fi
```

**Key Features:**

- âœ… Checks directory existence before PATH addition
- âœ… Prevents warning messages about missing directories
- âœ… Cleaner PATH with only valid entries

### Parser Format Alignment

**Feature:** Complete refactor of oradba_env_parser.sh for format consistency

Fixed field order mismatch between parser functions and actual file format.

**Old Format (mismatched):**

```text
PATH:PRODUCT:VERSION:EDITION:DB_TYPE:POSITION:DUMMY_SID:SHORT_NAME:DESCRIPTION
```

**New Format (correct):**

```text
NAME:PATH:TYPE:ORDER:ALIAS:DESCRIPTION:VERSION
```

**Functions Updated:**

- `oradba_parse_homes()` - Complete refactor to match actual format
- `oradba_find_home()` - Can search by NAME, ALIAS, or PATH
- `oradba_get_home_metadata()` - Supports old/new field names for compatibility
- `oradba_list_all_homes()` - Updated field positions and sorting
- `oradba_get_product_type()` - Added uppercase conversion

**Backward Compatibility:**

```bash
# Supports both old and new field names
oradba_get_home_metadata "$path" "Type"        # New name
oradba_get_home_metadata "$path" "Product"     # Old name (still works)

oradba_get_home_metadata "$path" "Name"        # New name
oradba_get_home_metadata "$path" "Short_Name"  # Old name (still works)
```

**Key Features:**

- âœ… Parser now matches actual oradba_homes.conf format
- âœ… Backward compatibility with old field names
- âœ… Search by NAME, ALIAS, or PATH
- âœ… Consistent field positions across all functions

## Improvements

### Display Enhancements

**oraup.sh Output Improvements:**

- Client/Instant Client homes now hidden (not services requiring monitoring)
- Data Safe connectors show with proper status and connector name
- Dummy entries only shown when actual databases exist
- Client dummy entries filtered out completely
- Grid Infrastructure shows as "Grid Infrastructure" (not "grid")
- Proper capitalization for all product types

**Before:**

```text
Oracle Homes
---------------------------------------------------------------------------------
Client          : client19     available   /u01/app/oracle/product/19/client
Instant Client  : iclient26    available   /opt/oracle/instantclient_26
Dummy rdbms     : client19     n/a         /u01/app/oracle/product/19/client
```

**After:**

```text
Oracle Homes
---------------------------------------------------------------------------------
Data Safe       : dsconha1     running     /appl/oracle/product/exacc-wob-vwg-ha1
Grid Infrastructure : grid19   available   /u01/app/19/grid
```

### Configuration Updates

**Product Sections:**

```ini
[RDBMS]
# Database-specific settings

[CLIENT]
# Full client settings

[ICLIENT]
# Instant Client settings

[DATASAFE]
# Data Safe connector settings

[GRID]
# Grid Infrastructure settings

[ASM]
# ASM settings

[OUD]
# Oracle Unified Directory settings

[WLS]
# WebLogic Server settings
```

## Bug Fixes

### DataSafe Environment Issues

- Fixed "Unknown product type" error for DataSafe homes
- Fixed "sqlplus not found" error (sqlplus not required)
- Fixed incorrect PATH (was adding non-existent bin directory)
- Fixed incorrect LD_LIBRARY_PATH (was not using oracle_cman_home/lib)
- Fixed oradba_homes.conf parsing delimiter (semicolon â†’ colon)
- Optimized status checking to use direct cmctl (no Python overhead)

### Client Environment Issues

- ICLIENT product type now properly detected and handled
- Instant Client PATH now includes ORACLE_HOME directly (not bin subdir)
- Instant Client LD_LIBRARY_PATH now includes ORACLE_HOME directly
- Client validations skip checks for database-specific features

### Parser Issues

- Fixed field order mismatch in oradba_env_parser.sh
- Updated all dependent functions to use correct format
- Added backward compatibility for old field names

## Files Changed

### Core Libraries

- `src/lib/oradba_common.sh` - Added deduplication function
- `src/lib/oradba_env_parser.sh` - Complete refactor (5 functions)
- `src/lib/oradba_env_builder.sh` - Added directory validation, deduplication
- `src/lib/oradba_env_validator.sh` - Enhanced product type detection
- `src/lib/oradba_env_status.sh` - Added DataSafe status checking

### Scripts

- `src/bin/oraup.sh` - Display improvements for non-DB homes
- `src/bin/oradba_homes.sh` - Support for new product types

### Configuration

- `src/etc/oradba_core.conf` - Added ICLIENT and DATASAFE sections
- `src/etc/oradba_standard.conf` - Product-specific defaults

### Documentation

- `README.md` - Updated with DataSafe and Instant Client support
- `doc/architecture.md` - Enhanced with product type details
- `CHANGELOG.md` - Complete change history

## Testing

### Test Coverage

All existing tests pass with new functionality:

- `test_oradba_env_config.bats` - Tests all product types (line 382)
- `test_oradba_env_status.bats` - Tests DataSafe status checking (lines 107-116)
- `test_oradba_env_status.bats` - Tests ICLIENT status (line 52)
- `test_oradba_env_parser.bats` - Tests Instant Client detection (lines 45, 189-191)

**Total Tests:** 910 tests  
**Pass Rate:** 100%  
**New Product Types Tested:** DATASAFE, ICLIENT

## Performance Improvements

- **DataSafe Status Checking:** 50-100ms faster (direct cmctl vs Python)
- **PATH Processing:** Reduced overhead with deduplication
- **Parser Performance:** More efficient with correct field positions

## Migration Guide

### From v1.0.0 to v1.1.0

This is a fully compatible minor release. No breaking changes.

**Optional Updates:**

1. **Add Data Safe Connectors:**

```bash
oradba_homes.sh add --name dsconn1 --path /path/to/connector --type datasafe
```

1. **Add Instant Client:**

```bash
oradba_homes.sh add --name ic26 --path /opt/oracle/instantclient_26 --type iclient
```

1. **Update Configuration (Optional):**

Add product-specific sections to `oradba_customer.conf`:

```ini
[DATASAFE]
# Custom Data Safe settings

[ICLIENT]
# Custom Instant Client settings
```

## Known Issues

### Empty oratab Handling

- System works with empty oratab but needs production testing
- Auto-discovery feature handles running instances without oratab entries

## Acknowledgments

This release addresses production issues identified after the v1.0.0 release,
with focus on Data Safe connector environments and Instant Client installations.

## Links

- **GitHub Release:** <https://github.com/oehrlis/oradba/releases/tag/v1.1.0>
- **Issue Tracker:** <https://github.com/oehrlis/oradba/issues>
- **Documentation:** <https://code.oradba.ch/oradba/>
- **Changelog:** [CHANGELOG.md](../../CHANGELOG.md)

## Support

For questions, issues, or feedback:

- **GitHub Issues:** <https://github.com/oehrlis/oradba/issues>
- **Email:** <stefan.oehrli@oradba.ch>
