# Release Notes v0.19.7

**Release Date:** 2026-01-22  
**Type:** Minor Release (Debug Support Enhancement - Phase 3 Completion)

## Overview

Version 0.19.7 completes the comprehensive debug support initiative by adding
Phase 3 debug capabilities to OraDBA's job automation and monitoring scripts.
This release builds on Phase 1 (infrastructure) and Phase 2 (management tools)
to provide complete debug visibility across all OraDBA operations.

## What's New

### ðŸ” Phase 3 Debug Support for Job Automation Scripts

**Enhanced Wrapper Scripts** (rman_jobs.sh, exp_jobs.sh, imp_jobs.sh)

- Added comprehensive debug logging for backup and monitoring wrapper operations
- Debug messages track argument processing, operation filtering, and script invocation
- Automatic debug flag propagation to underlying longops.sh when debug is enabled
- Operation-specific filtering with detailed tracing:
  - `rman_jobs.sh`: RMAN backup/restore operations (`RMAN%` filter)
  - `exp_jobs.sh`: DataPump export operations (`%EXP%` filter)
  - `imp_jobs.sh`: DataPump import operations (`%IMP%` filter)
- Enable with `ORADBA_DEBUG=true` or `--debug` flag
- Example: `ORADBA_DEBUG=true rman_jobs.sh -w -i 10` shows complete wrapper trace

**Core Monitoring** in longops.sh

- Added debug logging for long-running operation monitoring and SQL query construction
- Debug messages track WHERE clause building, operation filtering, and database connections
- Detailed visibility into watch mode iterations, environment sourcing, and timing
- Comprehensive SQL query debugging for v$session_longops operations
- Database connection establishment and Oracle Home environment setup tracing
- Enable with `ORADBA_DEBUG=true` or `--debug` flag
- Example: `longops.sh --debug -o "RMAN%" -w` shows SQL construction and execution

### ðŸŽ¯ Complete Debug Coverage

#### Three-Phase Implementation

- **Phase 1 (v0.19.5)**: Infrastructure scripts (oraup.sh, oraenv.sh, oradba_check.sh, etc.)
- **Phase 2 (v0.19.6)**: Management tools (oradba_dbctl.sh, oradba_lsnrctl.sh, oradba_services.sh)
- **Phase 3 (v0.19.7)**: Job automation (rman_jobs.sh, exp_jobs.sh, imp_jobs.sh, longops.sh)

#### Dual Activation Methods

- Environment variable: `export ORADBA_DEBUG=true`
- CLI flag: `--debug` or `-d` for individual script runs

#### Comprehensive Debug Features

- Wrapper script argument processing and operation filtering
- SQL query construction and WHERE clause building
- Database connection establishment and environment sourcing
- Watch mode iterations, timing, and monitoring loops
- Error handling and fallback mechanisms
- Oracle Home detection and plugin application

### ðŸ“š Enhanced Documentation

**Updated Troubleshooting Guide** (src/doc/troubleshooting.md)

- Complete Phase 1-3 debug documentation with real-world examples
- Organized debug examples by script categories (Infrastructure, Management, Job Automation)
- Usage patterns for environment issues, database operations, and monitoring tasks
- Debug output format documentation and performance considerations
- Legacy debug support documentation for backward compatibility

## Technical Details

### Debug Architecture Consistency

All Phase 3 scripts follow the established OraDBA debug patterns:

**Wrapper Scripts Pattern:**

```bash
# Early debug detection
[[ "${ORADBA_DEBUG}" == "true" ]] && DEBUG_ENABLED=true

# CLI flag processing
case "${arg}" in
    --debug|-d) DEBUG_ENABLED=true ;;
esac

# Debug logging with fallback
if command -v oradba_log >/dev/null 2>&1; then
    oradba_log DEBUG "${SCRIPT_NAME}: message"
else
    echo "DEBUG: ${SCRIPT_NAME}: message" >&2
fi
```

**Core Script Pattern:**

```bash
# Function-level debug instrumentation
debug_log "Starting function with arguments: $*"
debug_log "SQL WHERE clause: ${where_clause}"
debug_log "Executing sqlplus with exit code: ${exit_code}"
```

### Debug Coverage Areas

**Job Automation Scripts:**

- Wrapper argument filtering and processing
- Operation filter application (RMAN%, %EXP%, %IMP%)
- Target script invocation and debug flag propagation
- SQL query construction and execution tracing
- Database connection management and environment setup
- Watch mode timing and iteration management

## Usage Examples

### Backup Monitoring with Debug

```bash
# Monitor RMAN operations with debug
ORADBA_DEBUG=true rman_jobs.sh -w -i 10
# Shows: argument processing, filter setup, longops.sh invocation

# Monitor DataPump exports with debug
exp_jobs.sh --debug -o "%EXP%" --all
# Shows: wrapper operation, filter application, SQL query construction

# Core monitoring with debug
longops.sh --debug -o "RMAN%" -w ORCL FREE
# Shows: argument parsing, environment sourcing, SQL execution
```

### Combined Debug Scenarios

```bash
# Debug backup operations end-to-end
ORADBA_DEBUG=true rman_jobs.sh -w
# Shows: wrapper â†’ longops.sh â†’ SQL execution â†’ monitoring loop

# Debug with operation filtering
exp_jobs.sh --debug --operation "%Export%" --watch --interval 5
# Shows: filter construction, query building, watch mode iterations
```

## Compatibility

- **Backward Compatible**: All existing scripts and configurations continue to work unchanged
- **Debug Optional**: Debug output only appears when explicitly enabled via environment variable or CLI flag
- **Performance**: No performance impact when debug is disabled
- **Dependencies**: Works with or without oradba_common.sh library (graceful fallback)

## Testing

- **200/200 tests passed** - Complete test suite validation including new debug features
- **Lint clean** - All shell scripts and Markdown documentation pass quality checks
- **Integration tested** - Debug features validated across all wrapper and core scripts
- **Pattern consistency** - Follows established Phase 1-2 debug architecture

## Migration Notes

- **No migration required** - Debug features are additive and optional
- **Existing usage unchanged** - All scripts work exactly as before unless debug is enabled
- **Configuration preservation** - No changes to existing configuration files or settings

## Next Steps

This completes the comprehensive debug support initiative for OraDBA v0.19.x. With
Phase 1 (infrastructure), Phase 2 (management), and Phase 3 (job automation) debug
support, OraDBA now provides complete visibility into all operations:

- **Complete troubleshooting capability** for any OraDBA operation
- **Self-service debugging** for users to diagnose issues independently
- **Developer productivity** through detailed execution traces
- **Production support** with non-intrusive diagnostic capabilities

---

**Known Issues**: None identified.

**Contributors**: OraDBA Development Team
