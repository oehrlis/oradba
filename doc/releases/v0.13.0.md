# OraDBA v0.13.0 Release Notes

**Release Date:** January 2, 2026

## Overview

OraDBA v0.13.0 introduces a powerful RMAN wrapper script with template processing,
parallel execution, and automated notifications. This release also includes
important bug fixes for the extension system and new navigation aliases.

## üéâ New Features

### RMAN Wrapper Script (#52)

A comprehensive shell wrapper for executing RMAN scripts with enterprise-grade features:

**Key Features:**

- **Template Processing**: Dynamic substitution of RMAN script parameters
  - `<ALLOCATE_CHANNELS>`: Automatic channel allocation
  - `<FORMAT>`: Dynamic backup format strings
  - `<TAG>`: Dynamic backup tags
  - `<COMPRESSION>`: Compression levels (NONE|LOW|MEDIUM|HIGH)

- **Parallel Execution**: Run RMAN for multiple databases concurrently
  - Background jobs method (default)
  - GNU parallel support (auto-detected)
  - Configurable parallelism level

- **Dual Logging**: Comprehensive logging strategy
  - Generic wrapper log in `${ORADBA_LOG}`
  - SID-specific RMAN output in `${ORADBA_ORA_ADMIN_SID}/log`

- **Email Notifications**: Alert on success/failure
  - Configurable per-SID settings
  - Simple integration with mail/sendmail

- **SID-Specific Configuration**: Per-database defaults
  - Location: `${ORADBA_ORA_ADMIN_SID}/etc/oradba_rman.conf`
  - Override via command-line arguments

**Usage Examples:**

```bash
# Single database backup
oradba_rman.sh --sid FREE --rcv backup_full.rcv

# Multiple databases in parallel
oradba_rman.sh --sid "CDB1,CDB2,CDB3" --rcv backup_full.rcv --parallel 2

# Custom settings with notification
oradba_rman.sh --sid PROD --rcv backup_full.rcv \
    --channels 4 \
    --compression HIGH \
    --format "/backup/%d_%T_%U.bkp" \
    --tag MONTHLY_BACKUP \
    --notify dba@example.com

# Dry run to test template processing
oradba_rman.sh --sid FREE --rcv backup_full.rcv --dry-run
```

**Files:**

- `src/bin/oradba_rman.sh` - Main wrapper script (820+ lines)
- `src/etc/oradba_rman.conf.example` - Configuration template
- `src/rcv/backup_full.rcv` - Updated backup script with templates
- `tests/test_oradba_rman.bats` - Comprehensive test suite (36 tests)

### Base Directory Aliases

New navigation shortcuts for quick directory changes:

- `cdbase` - Change to `$ORADBA_BASE` directory
- Extension aliases via existing `cde<name>` pattern

### RMAN Script Extension Convention

Introduced new file extension convention for RMAN scripts:

- `.rcv` - RMAN scripts with template tags (new standard)
- `.rman` - Static RMAN scripts (legacy, still supported)

## üêõ Bug Fixes

### Extension Discovery

Fixed critical bug where `oradba_extension.sh list` would show empty or invalid extensions:

**Issue:**

```text
oracle@labdb:/opt/oracle/local/ [FREE] oradba_extension.sh list
OraDBA Extensions

NAME                 VERSION      PRIORITY   STATUS    
----                 -------      --------   ------    
                     unknown      50         Enabled

Total: 1 extension(s)
```

**Fix:**

- Enhanced directory exclusion in `discover_extensions()`
- Now properly skips main OraDBA installation directory
- Compares both directory name and full path to prevent false positives
- Handles cases where OraDBA is installed within `${ORADBA_LOCAL_BASE}`

## üìö Documentation Updates

Comprehensive documentation updates across multiple files:

- **`src/doc/09-rman-scripts.md`**: Complete RMAN wrapper documentation
  - Features overview
  - Usage syntax and options
  - Configuration guide
  - Template tags explanation
  - Multiple examples

- **`src/rcv/README.md`**: Template system documentation
  - Quick start examples
  - Template tag reference
  - Configuration options

- **`src/bin/README.md`**: Script reference updates
  - oradba_rman.sh entry
  - Usage examples

- **`README.md`**: Main project updates
  - RMAN wrapper in features list
  - Quick start examples

## üß™ Testing

### New Test Suite

Added comprehensive BATS test suite for RMAN wrapper:

- **36 tests** (35 passing, 1 skipped)
- Full coverage:
  - Argument parsing (all options)
  - Template processing (all 4 tags)
  - Configuration loading and overrides
  - Parallel execution modes
  - Dry-run functionality
  - Logging mechanisms
  - Error handling
  - Integration workflows

### Test Execution

```bash
# Run RMAN wrapper tests
bats tests/test_oradba_rman.bats

# Run all tests
make test
```

## üìã Version Information

- **Version**: 0.13.0
- **Release Date**: 2026-01-02
- **Previous Version**: 0.12.1
- **Type**: Minor Release (new features + bug fixes)

## üîß Upgrade Instructions

### From 0.12.x

1. Pull the latest version:

   ```bash
   cd /opt/oradba
   oraup.sh
   ```

2. The upgrade is backward compatible - no configuration changes required

3. To use the new RMAN wrapper:

   ```bash
   # Copy example configuration
   cp $ORADBA_PREFIX/etc/oradba_rman.conf.example \
      $ORADBA_ORA_ADMIN_SID/etc/oradba_rman.conf
   
   # Edit configuration
   vi $ORADBA_ORA_ADMIN_SID/etc/oradba_rman.conf
   ```

4. Update existing RMAN scripts (optional):
   - Rename `.rman` files to `.rcv`
   - Add template tags for dynamic substitution

## üîó Links

- **Repository**: <https://github.com/oehrlis/oradba>
- **Documentation**: <https://github.com/oehrlis/oradba/tree/main/src/doc>
- **Issue #52**: <https://github.com/oehrlis/oradba/issues/52>
- **Changelog**: [CHANGELOG.md](../../CHANGELOG.md)

## üë• Contributors

- Stefan Oehrli (@oehrlis) - Lead Developer

## üìù Notes

### RMAN Script Compatibility

- Existing `.rman` scripts continue to work without changes
- New `.rcv` extension is recommended for template-enabled scripts
- Direct RMAN execution (without wrapper) still supported for both file types

### Template Processing

Template tags are only processed when using `oradba_rman.sh` wrapper. Direct
RMAN execution will use static values or template tags verbatim.

### Parallel Execution

- Background jobs method works on all systems
- GNU parallel provides better resource management if installed
- Wrapper auto-detects and selects appropriate method

## üöÄ What's Next

Planned for future releases:

- SMTP support for email notifications (alternative to mail/sendmail)
- Additional template tags for advanced RMAN features
- RMAN catalog integration enhancements
- Backup validation and restore testing workflows

---

For complete details, see [CHANGELOG.md](../../CHANGELOG.md)
